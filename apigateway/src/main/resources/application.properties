spring.application.name=api-gateway
server.port=9443

spring.cloud.discovery.enabled=true
eureka.client.service-url.defaultZone=http://localhost:8761/eureka
management.endpoints.web.exposure.include=health,info

# Enable dynamic routing to services via service-id paths (e.g., /auth-service/**)
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# Explicit route to incuserservice so /auth/** works
spring.cloud.gateway.routes[0].id=usermanagement
spring.cloud.gateway.routes[0].uri=lb://usermanagement
spring.cloud.gateway.routes[0].predicates[0]=Path=/auth/**
spring.cloud.gateway.routes[0].filters[0]=RewritePath=/auth/(?<segment>.*), /api/auth/$\{segment}

# Explicit route to issue-service so /issues/** works
spring.cloud.gateway.routes[1].id=issueservice
spring.cloud.gateway.routes[1].uri=lb://issueservice
spring.cloud.gateway.routes[1].predicates[0]=Path=/issues/**
spring.cloud.gateway.routes[1].filters[0]=RewritePath=/issues/(?<segment>.*), /api/${segment}

# HTTPS configuration (expects keystore at classpath:keystore/apigateway.p12)
server.ssl.enabled=true
server.ssl.key-store=classpath:keystore/apigateway.p12
server.ssl.key-store-password=changeit
server.ssl.key-store-type=PKCS12
server.ssl.key-alias=apigateway
